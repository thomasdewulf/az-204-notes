# Web app settings

- App settings are passed as environment variables.
- For .NET, app settings in app service are equivalent to using web.config or appsettings.json. Values in App Service override values from those files.
- Settings are always encrypted-at-rest.
- Settings can be tied to a deployment slot.
- Nested keys can be separated by `:` on windows and by `_` on Linux.

## General settings

Management of common settings. Some settings are only available for higher pricing tiers.

- Stack: software stack and SDK version (e.g. .NET, Python). For Linux and custom container apps, an optional startup command or file can be provided
- Platform settings
  - Bitness: 32 or 64 bit
  - WebSocket: whether websockets are enabled or not
  - Always On: keeps the app loaded, even when there is no traffic. Disabled by default. When disabled, the app is unloaded after 20 minutes of inactivity. Required for continuous WebJobs or WebJobs triggered by a CRON expression
  - Managed pipeline version: IIS pipeline. Set to *Classic* if an older version of IIS is needed. **Is there support for other web servers?**
  - HTTP version: support for HTTPS/2
  - ARR affinity: used for routing client to the same instance for every request during the session. Can be disabled if application is stateless
- Debugging: Enable remote debugging. Disabled after 48 hours. Only for .NET
- Incoming client certificates: request client certificates in mutual auth. TLS mutual auth is used to restrict access to app by enabling different types of auth **Check further what this means**

## Path mappings

Used to configure handler mappings, and virtual directory and directory mappings. There are different options based on OS type.

### Windows

- Handler mappings allow adding custom script processors to handle requests for specific file extensions.
- Default root path (/) is mapped to `D:/home/site/wwwroot`
- Virtual applications or directories can be mapped, relative to `D:/home`

### Linux

- Custom storage

## Diagnostic logging

| Type | Platform | Location | Info |
| -- | -- | -- | -- |
| Application logging | Windows and Linux | File system and Blob Storage | Messages generated by the application. Logging to file system is automatically disabled 12 hours after enabling. Long term should go to Azure Blob Storage. Log level can be chosen during config |
| Web server logging | Windows | File sytem and Blob Storage |Raw HTTP request data in W3C format. |
| Detailed error logging | Windows | File system | Copy of the .htm error pages. Shouldn't be sent to the client. |
| Failed request tracing | Windows | File system | Detailed tracing on failed requests. |
| Deployment logging | Windows and linux | File system | Helps determine deployment failures. Happens automatically and can't be configured. |

Logs stored in the file system can be downloaded via the browser in a zip.

- Linux/container apps: https://<app-name>.scm.azurewebsites.net/api/logs/docker/zip
- Windows apps: https://<app-name>.scm.azurewebsites.net/api/dump

## Log streaming

Log type (see above) needs to be enabled before it can be streamed. Any file ending in .txt, .log or .htm that is stored in /LogFiles (d:home/logfiles) is streamed.

Streaming to terminal

```bash
az webapp log tail --name appname --resource-group rg-name
```
